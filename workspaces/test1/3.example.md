# æ‰“æ³¡æ³¡æ¸¸æˆç¤ºä¾‹å’Œå‚è€ƒ

---

## ğŸ® æ¸¸æˆç•Œé¢ç¤ºä¾‹

### ä¸»èœå•ç•Œé¢
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ³¡æ³¡å°„å‡»æ¸¸æˆ</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div class="game-container">
        <!-- ä¸»èœå• -->
        <div id="main-menu" class="menu-screen">
            <h1 class="game-title">ğŸ«§ æ³¡æ³¡å°„å‡»</h1>
            <div class="menu-buttons">
                <button class="btn btn-primary" id="start-game">å¼€å§‹æ¸¸æˆ</button>
                <button class="btn btn-secondary" id="level-select">é€‰æ‹©å…³å¡</button>
                <button class="btn btn-secondary" id="settings">è®¾ç½®</button>
                <button class="btn btn-secondary" id="help">å¸®åŠ©</button>
            </div>
            <div class="high-score">
                <p>æœ€é«˜åˆ†: <span id="high-score-value">0</span></p>
            </div>
        </div>
        
        <!-- æ¸¸æˆç•Œé¢ -->
        <div id="game-screen" class="game-screen hidden">
            <div class="game-header">
                <div class="score-info">
                    <span>åˆ†æ•°: <span id="current-score">0</span></span>
                    <span>å…³å¡: <span id="current-level">1</span></span>
                </div>
                <div class="game-controls">
                    <button class="btn btn-small" id="pause-btn">â¸ï¸</button>
                    <button class="btn btn-small" id="restart-btn">ğŸ”„</button>
                </div>
            </div>
            
            <canvas id="game-canvas" width="800" height="600"></canvas>
            
            <div class="game-footer">
                <div class="next-bubble">
                    <span>ä¸‹ä¸€ä¸ª:</span>
                    <div id="next-bubble-preview"></div>
                </div>
                <div class="power-meter">
                    <div class="power-bar">
                        <div id="power-fill"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
```

### CSSæ ·å¼ç¤ºä¾‹
```css
/* main.css */
:root {
    --primary-color: #667eea;
    --secondary-color: #764ba2;
    --accent-color: #ff6b6b;
    --text-color: #333;
    --bg-gradient: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
}

body {
    margin: 0;
    padding: 0;
    font-family: 'Arial', sans-serif;
    background: var(--bg-gradient);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
}

.game-container {
    width: 100%;
    max-width: 900px;
    margin: 0 auto;
    padding: 20px;
    box-sizing: border-box;
}

.menu-screen {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 20px;
    padding: 40px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
}

.game-title {
    font-size: 3rem;
    color: var(--primary-color);
    margin-bottom: 30px;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
}

.btn {
    padding: 12px 24px;
    border: none;
    border-radius: 25px;
    font-size: 1.1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    margin: 8px;
    min-width: 150px;
}

.btn-primary {
    background: var(--accent-color);
    color: white;
}

.btn-primary:hover {
    background: #ff5252;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
}

.btn-secondary {
    background: var(--primary-color);
    color: white;
}

.btn-secondary:hover {
    background: #5a6fd8;
    transform: translateY(-2px);
}

#game-canvas {
    border: 3px solid var(--primary-color);
    border-radius: 10px;
    background: linear-gradient(to bottom, #87ceeb, #e0f6ff);
    display: block;
    margin: 0 auto;
}

.hidden {
    display: none;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    .game-container {
        padding: 10px;
    }
    
    .game-title {
        font-size: 2rem;
    }
    
    .btn {
        min-width: 120px;
        font-size: 1rem;
    }
    
    #game-canvas {
        width: 100%;
        height: auto;
    }
}
```

---

## ğŸ¯ æ¸¸æˆé€»è¾‘ç¤ºä¾‹

### ä¸»æ¸¸æˆç±»
```javascript
// main.js
class BubbleGame {
    constructor() {
        this.canvas = document.getElementById('game-canvas');
        this.ctx = this.canvas.getContext('2d');
        this.gameState = 'menu';
        this.score = 0;
        this.level = 1;
        this.highScore = localStorage.getItem('bubbleGameHighScore') || 0;
        
        this.bubbleGrid = new BubbleGrid(12, 8);
        this.shooter = new Shooter(400, 550);
        this.audioManager = new AudioManager();
        this.particleSystem = new ParticleSystem();
        
        this.init();
    }
    
    init() {
        this.setupEventListeners();
        this.loadAssets();
        this.initLevel();
        this.gameLoop();
    }
    
    setupEventListeners() {
        // é¼ æ ‡äº‹ä»¶
        this.canvas.addEventListener('mousemove', (e) => {
            if (this.gameState === 'playing') {
                const rect = this.canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                this.shooter.aim(x, y);
            }
        });
        
        this.canvas.addEventListener('click', (e) => {
            if (this.gameState === 'playing') {
                this.shoot();
            }
        });
        
        // è§¦æ‘¸äº‹ä»¶
        this.canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (this.gameState === 'playing') {
                const touch = e.touches[0];
                const rect = this.canvas.getBoundingClientRect();
                const x = touch.clientX - rect.left;
                const y = touch.clientY - rect.top;
                this.shooter.aim(x, y);
                this.shoot();
            }
        });
        
        // é”®ç›˜äº‹ä»¶
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && this.gameState === 'playing') {
                e.preventDefault();
                this.shoot();
            }
        });
    }
    
    shoot() {
        const bubble = this.shooter.shoot();
        if (bubble) {
            this.audioManager.playSound('shoot');
            this.movingBubbles.push(bubble);
        }
    }
    
    gameLoop() {
        this.update();
        this.render();
        requestAnimationFrame(() => this.gameLoop());
    }
    
    update() {
        if (this.gameState !== 'playing') return;
        
        // æ›´æ–°ç§»åŠ¨çš„æ³¡æ³¡
        this.updateMovingBubbles();
        
        // æ›´æ–°ç²’å­ç³»ç»Ÿ
        this.particleSystem.update();
        
        // æ£€æŸ¥æ¸¸æˆç»“æŸæ¡ä»¶
        this.checkGameOver();
    }
    
    render() {
        // æ¸…ç©ºç”»å¸ƒ
        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
        
        // æ¸²æŸ“èƒŒæ™¯
        this.renderBackground();
        
        if (this.gameState === 'playing') {
            // æ¸²æŸ“æ¸¸æˆå…ƒç´ 
            this.bubbleGrid.render(this.ctx);
            this.shooter.render(this.ctx);
            this.renderMovingBubbles();
            this.particleSystem.render(this.ctx);
            this.renderUI();
        }
    }
}

// å¯åŠ¨æ¸¸æˆ
window.addEventListener('load', () => {
    new BubbleGame();
});
```

### æ³¡æ³¡ç±»ç¤ºä¾‹
```javascript
// Bubble.js
class Bubble {
    constructor(x, y, color, radius = 20) {
        this.x = x;
        this.y = y;
        this.originalX = x;
        this.originalY = y;
        this.color = color;
        this.radius = radius;
        this.vx = 0;
        this.vy = 0;
        this.state = 'static'; // static, moving, falling, exploding
        this.animationFrame = 0;
        this.glowIntensity = 0;
    }
    
    update() {
        switch (this.state) {
            case 'moving':
                this.x += this.vx;
                this.y += this.vy;
                break;
                
            case 'falling':
                this.vy += 0.5; // é‡åŠ›åŠ é€Ÿåº¦
                this.x += this.vx * 0.98; // ç©ºæ°”é˜»åŠ›
                this.y += this.vy;
                
                // æ—‹è½¬æ•ˆæœ
                this.rotation = (this.rotation || 0) + 0.1;
                break;
                
            case 'exploding':
                this.animationFrame++;
                this.glowIntensity = Math.sin(this.animationFrame * 0.3) * 0.5 + 0.5;
                
                if (this.animationFrame > 20) {
                    this.state = 'destroyed';
                }
                break;
                
            case 'static':
                // è½»å¾®çš„å‘¼å¸åŠ¨ç”»
                this.glowIntensity = Math.sin(Date.now() * 0.002) * 0.1 + 0.1;
                break;
        }
    }
    
    render(ctx) {
        if (this.state === 'destroyed') return;
        
        ctx.save();
        
        // åº”ç”¨å˜æ¢
        ctx.translate(this.x, this.y);
        if (this.rotation) {
            ctx.rotate(this.rotation);
        }
        
        // çˆ†ç‚¸æ•ˆæœ
        if (this.state === 'exploding') {
            const scale = 1 + (this.animationFrame / 20) * 0.5;
            const alpha = 1 - (this.animationFrame / 20);
            ctx.globalAlpha = alpha;
            ctx.scale(scale, scale);
        }
        
        // å‘å…‰æ•ˆæœ
        if (this.glowIntensity > 0) {
            ctx.shadowColor = this.color;
            ctx.shadowBlur = this.glowIntensity * 20;
        }
        
        // ç»˜åˆ¶ä¸»ä½“
        ctx.beginPath();
        ctx.arc(0, 0, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = this.color;
        ctx.fill();
        
        // ç»˜åˆ¶é«˜å…‰
        const gradient = ctx.createRadialGradient(-5, -5, 0, -5, -5, this.radius * 0.7);
        gradient.addColorStop(0, 'rgba(255, 255, 255, 0.8)');
        gradient.addColorStop(1, 'rgba(255, 255, 255, 0)');
        
        ctx.beginPath();
        ctx.arc(0, 0, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = gradient;
        ctx.fill();
        
        // ç»˜åˆ¶è¾¹æ¡†
        ctx.beginPath();
        ctx.arc(0, 0, this.radius, 0, Math.PI * 2);
        ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
        ctx.lineWidth = 2;
        ctx.stroke();
        
        ctx.restore();
    }
    
    // æ£€æŸ¥ä¸å¦ä¸€ä¸ªæ³¡æ³¡çš„ç¢°æ’
    collidesWith(other) {
        const dx = this.x - other.x;
        const dy = this.y - other.y;
        const distance = Math.sqrt(dx * dx + dy * dy);
        return distance < (this.radius + other.radius);
    }
    
    // è·å–é¢œè‰²çš„RGBå€¼
    getColorRGB() {
        const colors = {
            '#FF6B6B': [255, 107, 107],
            '#FFB347': [255, 179, 71],
            '#FFD93D': [255, 217, 61],
            '#6BCF7F': [107, 207, 127],
            '#4ECDC4': [78, 205, 196],
            '#A8E6CF': [168, 230, 207],
            '#FFB3BA': [255, 179, 186]
        };
        return colors[this.color] || [255, 255, 255];
    }
}
```

---

## ğŸµ éŸ³æ•ˆå’ŒåŠ¨ç”»ç¤ºä¾‹

### éŸ³æ•ˆç®¡ç†
```javascript
// AudioManager.js
class AudioManager {
    constructor() {
        this.sounds = {
            shoot: 'assets/sounds/shoot.mp3',
            pop: 'assets/sounds/pop.mp3',
            drop: 'assets/sounds/drop.mp3',
            levelComplete: 'assets/sounds/level-complete.mp3',
            gameOver: 'assets/sounds/game-over.mp3'
        };
        
        this.audioElements = {};
        this.enabled = true;
        this.volume = 0.7;
        
        this.loadSounds();
    }
    
    loadSounds() {
        for (const [name, src] of Object.entries(this.sounds)) {
            const audio = new Audio(src);
            audio.preload = 'auto';
            audio.volume = this.volume;
            this.audioElements[name] = audio;
        }
    }
    
    playSound(name, volume = 1.0) {
        if (!this.enabled) return;
        
        const audio = this.audioElements[name];
        if (audio) {
            audio.currentTime = 0;
            audio.volume = this.volume * volume;
            audio.play().catch(e => console.log('Audio play failed:', e));
        }
    }
    
    setVolume(volume) {
        this.volume = Math.max(0, Math.min(1, volume));
        for (const audio of Object.values(this.audioElements)) {
            audio.volume = this.volume;
        }
    }
    
    toggle() {
        this.enabled = !this.enabled;
        return this.enabled;
    }
}
```

### ç²’å­æ•ˆæœç³»ç»Ÿ
```javascript
// ParticleSystem.js
class Particle {
    constructor() {
        this.reset();
    }
    
    reset() {
        this.x = 0;
        this.y = 0;
        this.vx = 0;
        this.vy = 0;
        this.life = 0;
        this.maxLife = 0;
        this.color = '#ffffff';
        this.size = 1;
        this.alpha = 1;
    }
    
    init(x, y, color) {
        this.x = x;
        this.y = y;
        this.color = color;
        this.life = this.maxLife = 30 + Math.random() * 20;
        this.size = 2 + Math.random() * 3;
        this.vx = (Math.random() - 0.5) * 8;
        this.vy = (Math.random() - 0.5) * 8 - 2;
        this.alpha = 1;
    }
    
    update() {
        this.x += this.vx;
        this.y += this.vy;
        this.vy += 0.2; // é‡åŠ›
        this.vx *= 0.98; // é˜»åŠ›
        
        this.life--;
        this.alpha = this.life / this.maxLife;
        this.size *= 0.98;
        
        return this.life > 0;
    }
    
    render(ctx) {
        ctx.save();
        ctx.globalAlpha = this.alpha;
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
        ctx.restore();
    }
}

class ParticleSystem {
    constructor() {
        this.particles = [];
        this.pool = [];
    }
    
    createExplosion(x, y, color, count = 15) {
        for (let i = 0; i < count; i++) {
            const particle = this.getParticle();
            particle.init(x, y, color);
            this.particles.push(particle);
        }
    }
    
    createTrail(x, y, color) {
        const particle = this.getParticle();
        particle.init(x, y, color);
        particle.life = particle.maxLife = 10;
        particle.size = 1;
        this.particles.push(particle);
    }
    
    update() {
        for (let i = this.particles.length - 1; i >= 0; i--) {
            const particle = this.particles[i];
            if (!particle.update()) {
                this.particles.splice(i, 1);
                this.returnParticle(particle);
            }
        }
    }
    
    render(ctx) {
        for (const particle of this.particles) {
            particle.render(ctx);
        }
    }
    
    getParticle() {
        return this.pool.pop() || new Particle();
    }
    
    returnParticle(particle) {
        particle.reset();
        this.pool.push(particle);
    }
}
```

---

## ğŸ“Š å…³å¡æ•°æ®ç¤ºä¾‹

### å…³å¡é…ç½®
```javascript
// levels.js
const LEVELS = [
    {
        id: 1,
        name: "åˆå­¦è€…",
        bubbles: [
            ['red', 'blue', 'red', 'blue', 'red', 'blue', 'red', 'blue'],
            ['blue', 'red', 'blue', 'red', 'blue', 'red', 'blue'],
            ['red', 'blue', 'red', 'blue', 'red', 'blue', 'red', 'blue'],
            ['blue', 'red', 'blue', 'red', 'blue', 'red', 'blue']
        ],
        colors: ['red', 'blue'],
        targetScore: 1000,
        timeLimit: null
    },
    
    {
        id: 2,
        name: "å½©è™¹æŒ‘æˆ˜",
        bubbles: [
            ['red', 'orange', 'yellow', 'green', 'blue', 'purple', 'red', 'orange'],
            ['orange', 'yellow', 'green', 'blue', 'purple', 'red', 'orange'],
            ['yellow', 'green', 'blue', 'purple', 'red', 'orange', 'yellow', 'green'],
            ['green', 'blue', 'purple', 'red', 'orange', 'yellow', 'green'],
            ['blue', 'purple', 'red', 'orange', 'yellow', 'green', 'blue', 'purple']
        ],
        colors: ['red', 'orange', 'yellow', 'green', 'blue', 'purple'],
        targetScore: 2500,
        timeLimit: 180
    },
    
    {
        id: 3,
        name: "ç²¾ç¡®å°„å‡»",
        bubbles: [
            [null, null, 'red', 'red', 'red', null, null, null],
            [null, 'blue', 'blue', 'red', 'blue', 'blue', null],
            ['green', 'green', null, 'red', null, 'green', 'green', null],
            [null, 'yellow', 'yellow', 'red', 'yellow', 'yellow'],
            [null, null, 'purple', 'purple', 'purple', null, null, null]
        ],
        colors: ['red', 'blue', 'green', 'yellow', 'purple'],
        targetScore: 3000,
        timeLimit: 120,
        specialRules: {
            limitedShots: 20,
            noWallBounce: true
        }
    }
];

// åŠ¨æ€ç”Ÿæˆå…³å¡
function generateRandomLevel(difficulty = 1) {
    const colors = ['red', 'blue', 'green', 'yellow', 'orange', 'purple'];
    const rows = 4 + Math.floor(difficulty / 2);
    const cols = 8;
    const colorCount = Math.min(3 + difficulty, colors.length);
    const levelColors = colors.slice(0, colorCount);
    
    const bubbles = [];
    for (let row = 0; row < rows; row++) {
        const bubbleRow = [];
        const colCount = cols - (row % 2);
        
        for (let col = 0; col < colCount; col++) {
            // éšæœºå†³å®šæ˜¯å¦æ”¾ç½®æ³¡æ³¡
            if (Math.random() < 0.8) {
                const color = levelColors[Math.floor(Math.random() * levelColors.length)];
                bubbleRow.push(color);
            } else {
                bubbleRow.push(null);
            }
        }
        bubbles.push(bubbleRow);
    }
    
    return {
        id: `random_${difficulty}`,
        name: `éšæœºå…³å¡ ${difficulty}`,
        bubbles,
        colors: levelColors,
        targetScore: 1000 * difficulty,
        timeLimit: Math.max(60, 180 - difficulty * 10)
    };
}
```

---

## ğŸ¯ æ¸¸æˆé…ç½®ç¤ºä¾‹

### æ¸¸æˆå¸¸é‡
```javascript
// config.js
const GAME_CONFIG = {
    // ç”»å¸ƒè®¾ç½®
    CANVAS_WIDTH: 800,
    CANVAS_HEIGHT: 600,
    
    // æ³¡æ³¡è®¾ç½®
    BUBBLE_RADIUS: 20,
    BUBBLE_COLORS: [
        '#FF6B6B', // çº¢è‰²
        '#FFB347', // æ©™è‰²
        '#FFD93D', // é»„è‰²
        '#6BCF7F', // ç»¿è‰²
        '#4ECDC4', // é’è‰²
        '#A8E6CF', // æµ…ç»¿
        '#FFB3BA'  // ç²‰è‰²
    ],
    
    // ç½‘æ ¼è®¾ç½®
    GRID_ROWS: 12,
    GRID_COLS: 8,
    HEX_OFFSET_X: 20,
    HEX_OFFSET_Y: 17.32, // sqrt(3) * radius
    
    // ç‰©ç†è®¾ç½®
    GRAVITY: 0.5,
    FRICTION: 0.98,
    BOUNCE_RESTITUTION: 0.8,
    SHOOT_SPEED: 12,
    
    // æ¸¸æˆè§„åˆ™
    MIN_MATCH_COUNT: 3,
    SCORE_PER_BUBBLE: 10,
    COMBO_MULTIPLIER: 1.5,
    DROP_BONUS: 5,
    
    // åŠ¨ç”»è®¾ç½®
    EXPLOSION_DURATION: 20,
    FALL_ACCELERATION: 0.5,
    PARTICLE_COUNT: 15,
    
    // éŸ³æ•ˆè®¾ç½®
    SOUND_VOLUME: 0.7,
    MUSIC_VOLUME: 0.4,
    
    // æ§åˆ¶è®¾ç½®
    AIM_SENSITIVITY: 1.0,
    TOUCH_THRESHOLD: 10,
    
    // æ€§èƒ½è®¾ç½®
    TARGET_FPS: 60,
    MAX_PARTICLES: 200,
    OBJECT_POOL_SIZE: 100
};

// éš¾åº¦è®¾ç½®
const DIFFICULTY_SETTINGS = {
    easy: {
        colors: 4,
        timeLimit: null,
        aimAssist: true,
        trajectoryPreview: true
    },
    
    normal: {
        colors: 5,
        timeLimit: 300,
        aimAssist: true,
        trajectoryPreview: false
    },
    
    hard: {
        colors: 6,
        timeLimit: 180,
        aimAssist: false,
        trajectoryPreview: false,
        limitedShots: true
    },
    
    expert: {
        colors: 7,
        timeLimit: 120,
        aimAssist: false,
        trajectoryPreview: false,
        limitedShots: true,
        movingTarget: true
    }
};
```

è¿™äº›ç¤ºä¾‹æ–‡ä»¶æä¾›äº†å®Œæ•´çš„æ¸¸æˆå¼€å‘å‚è€ƒï¼ŒåŒ…æ‹¬ï¼š

1. **ç•Œé¢è®¾è®¡**: HTMLç»“æ„å’ŒCSSæ ·å¼
2. **æ¸¸æˆé€»è¾‘**: æ ¸å¿ƒç±»å’Œç®—æ³•å®ç°
3. **éŸ³æ•ˆç³»ç»Ÿ**: éŸ³é¢‘ç®¡ç†å’Œæ’­æ”¾
4. **ç²’å­æ•ˆæœ**: è§†è§‰ç‰¹æ•ˆå®ç°
5. **å…³å¡æ•°æ®**: å…³å¡é…ç½®å’Œç”Ÿæˆ
6. **æ¸¸æˆé…ç½®**: å¸¸é‡å’Œè®¾ç½®å‚æ•°

ç°åœ¨æˆ‘ä»¬æœ‰äº†å®Œæ•´çš„é¡¹ç›®éœ€æ±‚å’ŒæŠ€æœ¯è§„èŒƒï¼Œå¯ä»¥ä½¿ç”¨æ™ºèƒ½ä½“ç³»ç»Ÿæ¥å®ç°è¿™ä¸ªæ¸¸æˆäº†ï¼
