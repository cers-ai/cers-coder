# 打泡泡游戏开发规则

---

## 🎯 开发目标与原则

### 核心目标
- 创建一个**有趣、流畅、易上手**的打泡泡网页游戏
- 实现**现代化的用户界面**和**优秀的用户体验**
- 确保游戏在**各种设备**上都能良好运行
- 代码结构**清晰、可维护、可扩展**

### 设计原则
1. **简单易懂**: 游戏规则简单，操作直观
2. **视觉吸引**: 色彩丰富，动画流畅
3. **性能优先**: 保证60FPS流畅运行
4. **响应式设计**: 适配各种屏幕尺寸
5. **渐进增强**: 基础功能优先，高级功能可选

---

## 🏗️ 技术架构规则

### 文件结构规范
```
src/
├── index.html          # 主页面
├── css/
│   ├── main.css        # 主样式文件
│   ├── game.css        # 游戏界面样式
│   └── responsive.css  # 响应式样式
├── js/
│   ├── main.js         # 主入口文件
│   ├── game/
│   │   ├── Game.js     # 游戏主类
│   │   ├── Bubble.js   # 泡泡类
│   │   ├── Shooter.js  # 发射器类
│   │   ├── Physics.js  # 物理引擎
│   │   └── Utils.js    # 工具函数
│   ├── ui/
│   │   ├── UI.js       # 界面管理
│   │   └── Menu.js     # 菜单系统
│   └── audio/
│       └── AudioManager.js # 音频管理
├── assets/
│   ├── images/         # 图片资源
│   ├── sounds/         # 音效文件
│   └── data/           # 关卡数据
└── tests/              # 测试文件
```

### 代码规范
1. **命名规范**:
   - 类名使用PascalCase: `BubbleGame`, `PhysicsEngine`
   - 方法名使用camelCase: `shootBubble()`, `checkCollision()`
   - 常量使用UPPER_CASE: `MAX_BUBBLES`, `GAME_WIDTH`
   - 文件名使用PascalCase: `Game.js`, `Bubble.js`

2. **注释规范**:
   - 每个类和重要方法都要有JSDoc注释
   - 复杂算法要有详细的行内注释
   - 配置参数要有说明注释

3. **代码组织**:
   - 每个类单独一个文件
   - 相关功能模块化组织
   - 避免全局变量，使用模块化导入导出

---

## 🎮 游戏机制规则

### 泡泡系统
1. **泡泡属性**:
   - 颜色: 6-8种基础颜色
   - 大小: 统一直径，适配网格
   - 状态: 静止、移动、消除中、掉落中

2. **网格系统**:
   - 使用六边形网格布局
   - 奇偶行错位排列
   - 网格坐标与像素坐标转换

3. **消除规则**:
   - 3个或以上相同颜色相邻泡泡消除
   - 使用深度优先搜索检测连通性
   - 失去支撑的泡泡自动掉落

### 物理系统
1. **碰撞检测**:
   - 圆形与圆形碰撞检测
   - 边界碰撞检测
   - 网格位置吸附

2. **运动轨迹**:
   - 直线运动为主
   - 支持墙壁反弹
   - 重力影响掉落泡泡

### 射击系统
1. **瞄准机制**:
   - 鼠标/触摸点击瞄准
   - 显示轨迹预览线
   - 考虑反弹路径

2. **发射规则**:
   - 固定发射速度
   - 泡泡自动吸附到最近网格
   - 发射后生成新的待发射泡泡

---

## 🎨 视觉设计规则

### 色彩规范
1. **泡泡颜色**:
   - 红色: #FF6B6B
   - 橙色: #FFB347
   - 黄色: #FFD93D
   - 绿色: #6BCF7F
   - 蓝色: #4ECDC4
   - 紫色: #A8E6CF
   - 粉色: #FFB3BA

2. **界面色彩**:
   - 主背景: 渐变蓝色 #667eea → #764ba2
   - UI背景: 半透明白色 rgba(255,255,255,0.9)
   - 文字颜色: #333333
   - 强调色: #FF6B6B

### 动画规范
1. **缓动函数**: 使用ease-out为主，营造自然感
2. **动画时长**: 
   - 快速反馈: 0.1-0.2s
   - 界面切换: 0.3-0.5s
   - 游戏动画: 0.5-1.0s
3. **性能要求**: 优先使用CSS3动画，复杂动画使用Canvas

### 响应式规则
1. **断点设置**:
   - 手机: 320px - 767px
   - 平板: 768px - 1023px
   - 桌面: 1024px+

2. **适配策略**:
   - 游戏区域等比缩放
   - UI元素相对定位
   - 触摸友好的按钮大小

---

## 🔧 性能优化规则

### 渲染优化
1. **Canvas优化**:
   - 使用离屏Canvas预渲染
   - 只重绘变化区域
   - 合理使用requestAnimationFrame

2. **对象管理**:
   - 实现对象池避免频繁创建销毁
   - 及时清理不用的事件监听器
   - 避免内存泄漏

### 资源管理
1. **图片优化**:
   - 使用WebP格式（降级PNG）
   - 合理的图片尺寸
   - 雪碧图合并小图标

2. **音频优化**:
   - 使用Web Audio API
   - 音频文件预加载
   - 支持音效开关

---

## 🧪 测试规则

### 功能测试
1. **核心功能**:
   - 泡泡射击和消除
   - 分数计算
   - 关卡切换
   - 游戏状态管理

2. **兼容性测试**:
   - 主流浏览器测试
   - 移动设备测试
   - 不同屏幕尺寸测试

### 性能测试
1. **帧率测试**: 确保60FPS稳定运行
2. **内存测试**: 长时间游戏无内存泄漏
3. **加载测试**: 首屏加载时间<3秒

---

## 📱 用户体验规则

### 交互设计
1. **操作反馈**:
   - 点击有视觉和音频反馈
   - 加载状态有进度提示
   - 错误操作有友好提示

2. **易用性**:
   - 重要按钮足够大（最小44px）
   - 操作流程简单直观
   - 支持撤销和重新开始

### 可访问性
1. **键盘支持**: 支持Tab导航和空格操作
2. **色彩对比**: 确保足够的对比度
3. **字体大小**: 最小12px，重要信息14px+

---

## 🚀 部署规则

### 构建要求
1. **代码压缩**: HTML/CSS/JS文件压缩
2. **资源优化**: 图片压缩，音频格式优化
3. **缓存策略**: 合理设置缓存头

### 部署环境
1. **静态托管**: 支持GitHub Pages、Netlify等
2. **HTTPS**: 必须使用HTTPS协议
3. **CDN**: 静态资源使用CDN加速

---

## 📋 开发流程规则

### 迭代计划
1. **第一阶段**: 核心游戏逻辑实现
2. **第二阶段**: 界面美化和动画效果
3. **第三阶段**: 音效和特效添加
4. **第四阶段**: 性能优化和测试
5. **第五阶段**: 部署和文档完善

### 质量控制
1. **代码审查**: 每个功能模块完成后进行审查
2. **测试覆盖**: 核心功能必须有测试用例
3. **性能监控**: 定期检查性能指标
4. **用户反馈**: 收集并及时响应用户反馈

---

## 🎯 成功标准

### 功能完整性
- [ ] 所有核心功能正常工作
- [ ] 游戏逻辑正确无误
- [ ] 界面美观易用
- [ ] 性能达标

### 用户体验
- [ ] 操作流畅自然
- [ ] 视觉效果吸引人
- [ ] 音效搭配合适
- [ ] 响应式适配良好

### 技术质量
- [ ] 代码结构清晰
- [ ] 注释文档完整
- [ ] 测试覆盖充分
- [ ] 性能优化到位
